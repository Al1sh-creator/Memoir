<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memoir â€¢ Analytics</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="shared.css">
    <link rel="stylesheet" href="pg1.css">
    <link rel="stylesheet" href="analytics.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="shared.js"></script>
    <script src="auth.js"></script>
    <style>
        .analytics-card { border-radius: 24px; border: none; background: white; transition: transform 0.3s ease; }
        .stat-value { font-size: 1.8rem; font-weight: 800; color: #0d6efd; }
        .suggestion-box { background: #eef6ff; border-left: 5px solid #0d6efd; border-radius: 12px; padding: 15px; margin-bottom: 10px; }
    </style>
</head>
<body class="bg-light">
    <div class="doodle-layer">
  <span class="doodle circle"></span>
  <span class="doodle zigzag"></span>
  <span class="doodle blob"></span>
  <span class="doodle star"></span>
    <span class="doodle circle"></span>
  <span class="doodle zigzag"></span>
  <span class="doodle blob"></span>
  <span class="doodle star"></span>
    <span class="doodle circle"></span>
  <span class="doodle zigzag"></span>
  <span class="doodle blob"></span>
  <span class="doodle star"></span>
</div>
    <div class="d-flex">
        <nav class="sidebar d-flex flex-column align-items-center bg-black vh-100 py-4 rounded">
    <div class="mb-4"><i class="fa-solid fa-owl fs-3"></i></div>

    <div class="nav-icons d-flex flex-column gap-2">
        <a href="pg1.html" class="text-decoration-none" data-bs-toggle="tooltip" data-bs-placement="right" title="Dashboard">
            <div class="icon-box"><i class="bi bi-speedometer"></i></div>
        </a>
        <a href="timer.html" class="text-decoration-none" data-bs-toggle="tooltip" data-bs-placement="right" title="Timer">
            <div class="icon-box"><i class="bi bi-stopwatch"></i></div>
        </a>
        <a href="Sessions.html" class="text-decoration-none" data-bs-toggle="tooltip" data-bs-placement="right" title="Study Sessions">
            <div class="icon-box">
                <i class="bi bi-book"></i>
                <span class="sessions-nav-count" data-sessions-badge></span>
            </div>
        </a>
        <a href="calendar.html" class="text-decoration-none" data-bs-toggle="tooltip" data-bs-placement="right" title="Calendar">
            <div class="icon-box"><i class="bi bi-calendar3"></i></div>
        </a>
        <a href="subjects.html" class="text-decoration-none" data-bs-toggle="tooltip" data-bs-placement="right" title="Subjects">
            <div class="icon-box"><i class="bi bi-mortarboard-fill"></i></div>
        </a>
        <a href="badges1.html" class="text-decoration-none" data-bs-toggle="tooltip" data-bs-placement="right" title="Badges & Trophies">
            <div class="icon-box"><i class="bi bi-trophy-fill"></i></div>
        </a>
          <a href="analytics.html" class="text-decoration-none" data-bs-toggle="tooltip" title="Analytics">
    <div class="icon-box active">
        <i class="bi bi-bar-chart-line"></i>
    </div>
</a>
        <a href="settings.html" class="text-decoration-none" data-bs-toggle="tooltip" data-bs-placement="right" title="Settings">
            <div class="icon-box"><i class="bi bi-gear"></i></div>
        </a>
    </div>

    <div class="mt-auto mb-3">
        <a href="#" class="text-decoration-none" data-bs-toggle="tooltip" data-bs-placement="right" title="Logout" onclick="handleLogout()">
            <div class="icon-box logout-btn">
                <i class="bi bi-box-arrow-right"></i>
            </div>
        </a>
    </div>  
</nav>

        <main class="flex-grow-1 p-4">
            <h2 class="fw-bold mb-4">Study Insights</h2>
            
            <div class="row g-3 mb-4 text-center">
                <div class="col-6 col-md-3">
                    <div class="card analytics-card shadow-sm p-3">
                        <p class="text-muted small mb-1">Total Hours</p>
                        <div class="stat-value" id="totalHours">0</div>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="card analytics-card shadow-sm p-3">
                        <p class="text-muted small mb-1">Current Streak</p>
                        <div class="stat-value" id="streakDays">0</div>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="card analytics-card shadow-sm p-3">
                        <p class="text-muted small mb-1">Avg Focus</p>
                        <div class="stat-value" id="avgSession">0m</div>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="card analytics-card shadow-sm p-3">
                        <p class="text-muted small mb-1">Productivity</p>
                        <div class="stat-value" id="prodScore">0%</div>
                    </div>
                </div>
            </div>

            <div class="row g-4 mb-4">
                <div class="col-lg-8">
                    <div class="card analytics-card shadow-sm p-4 h-100">
                        <h6 class="fw-bold mb-3">Study Time (Daily)</h6>
                        <canvas id="timeChart"></canvas>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card analytics-card shadow-sm p-4 h-100">
                        <h6 class="fw-bold mb-3">Subject Breakdown</h6>
                        <canvas id="subjectChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card analytics-card shadow-sm p-4">
                <h6 class="fw-bold mb-3">Smart Suggestions</h6>
                <div id="suggestionsContainer"></div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Check authentication first
            if (!auth.requireAuth()) {
                return; // Will redirect to login
            }
        });
    </script>
    <script src="sessions.js"></script>
    <script src="analytics.js"></script>

    <script>
        function handleLogout() {
            auth.logout();
            window.location.href = 'landing.html';
        }
    </script>
</body>
</html>